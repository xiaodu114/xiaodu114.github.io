<!DOCTYPE html>
<html lang="zh-cmn-Hans">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <title>Python - xiaodu114.github.io</title>
        <meta name="keywords" content="Python,pip,venv,Poetry" />
        <meta name="description" content="之前管理 Python 的种种都分散到各篇笔记中了，这里整理汇集一下 Python 相关的东东，例如：Python 的安装、pip 和 venv 的安装和使用、Poetry 的安装等" />

        <script src="/p/_/js/main.js"></script>
    </head>

    <body>
        <!-- github访问地址：/p/python/index.html -->
        <div class="blog-page">
            <h1>Python</h1>
            <ul>
                <li>
                    <a href="https://www.python.org/" target="_blank" rel="noopener noreferrer">Welcome to Python.org</a>
                </li>
                <li>
                    <a href="https://docs.python.org/3" target="_blank" rel="noopener noreferrer">Python 3.x Documentation</a>
                </li>
            </ul>
            <h2>环境准备</h2>
            <p>开始搞项目之前先把他需要的一些常见的环境都弄好，例如：python、pip、venv、Poetry 等</p>
            <h3>Python</h3>
            <p>这里说一下在不同的操作系统下如何安装<line-code>Python</line-code></p>
            <h4>Ubuntu 22.04</h4>
            <p><line-code>Ubuntu 22.04</line-code>已经默认安装了<line-code>Python</line-code>，这里的版本是：3.10.12</p>
            <pre ddz-class="here-need-to-handle-by-highlight" ddz-lang="bash">
#   检查版本
python3 -V
            </pre>
            <h3>pip</h3>
            <ul>
                <li>
                    <a href="https://github.com/pypa/pip" target="_blank" rel="noopener noreferrer">GitHub - pypa/pip: The Python package installer</a>
                </li>
                <li>
                    <a href="https://pip.pypa.io/" target="_blank" rel="noopener noreferrer">pip documentation</a>
                </li>
                <li>
                    <a href="https://pypi.org/" target="_blank" rel="noopener noreferrer">PyPI · The Python Package Index</a>
                </li>
            </ul>
            <h4>Ubuntu 22.04</h4>
            <pre ddz-class="here-need-to-handle-by-highlight" ddz-lang="bash">
#   检查 pip 版本：pip -V
sudo apt install python3-pip
            </pre>
            <h5>设置清华镜像源</h5>
            <p>参考地址：<a href="https://mirrors.tuna.tsinghua.edu.cn/help/pypi/" target="_blank" rel="noopener noreferrer"> pypi | 镜像站使用帮助 | 清华大学开源软件镜像站 | Tsinghua Open Source Mirror</a></p>
            <pre ddz-class="here-need-to-handle-by-highlight" ddz-lang="bash">
#   临时使用清华镜像来升级 pip
python3 -m pip install -i https://pypi.tuna.tsinghua.edu.cn/simple --upgrade pip
#   全局设置
pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple
            </pre>
            <h3>venv</h3>
            <p>他和<line-code>pip</line-code>应该是好基友</p>
            <h4>Ubuntu 22.04</h4>
            <pre ddz-class="here-need-to-handle-by-highlight" ddz-lang="bash">
sudo apt install python3-venv
            </pre>
            <h5>虚拟环境</h5>
            <pre ddz-class="here-need-to-handle-by-highlight" ddz-lang="bash">
#   创建
python3 -m venv venv
#   激活
source ./venv/bin/activate
#   退出虚拟环境
deactivate
#   安装依赖（添加到这里，使用的时候方便一些）
pip install -r requirements.txt 

#   你可以创建多个虚拟环境
python3 -m venv venv1
source ./venv1/bin/activate

python3 -m venv venv2
source ./venv2/bin/activate
            </pre>
            <h4>Windows</h4>
            <pre ddz-class="here-need-to-handle-by-highlight" ddz-lang="bash">
#   创建虚拟环境
python -m venv venv
#   激活虚拟环境
.\venv\scripts\activate
#   退出虚拟环境
deactivate
#   安装依赖（添加到这里，使用的时候方便一些）
pip install -r requirements.txt 

#   你可以创建多个虚拟环境
python -m venv venv1
.\venv1\scripts\activate

python -m venv venv2
.\venv2\scripts\activate
            </pre>
            <h3>Poetry</h3>
            <ul>
                <li>
                    <a href="https://python-poetry.org/" target="_blank" rel="noopener noreferrer">Poetry - Python dependency management and packaging made easy</a>
                </li>
                <li>
                    <a href="https://github.com/python-poetry/poetry" target="_blank" rel="noopener noreferrer">GitHub - python-poetry/poetry: Python packaging and dependency management made easy</a>
                </li>
                <li>
                    <a href="https://python-poetry.org/docs/" target="_blank" rel="noopener noreferrer"> Introduction | Documentation | Poetry - Python dependency management and packaging made easy</a>
                </li>
            </ul>
            <details>
                <summary>一些常用的命令</summary>
                <ol>
                    <li>
                        安装依赖
                        <ul>
                            <li>poetry install：安装项目依赖。</li>
                            <li>poetry install -h：查看安装选项。</li>
                        </ul>
                    </li>
                    <li>
                        添加依赖
                        <ul>
                            <li>poetry add &lt;package>：添加一个依赖到你的项目。</li>
                            <li>poetry add &lt;package> --dev：将依赖添加到开发依赖中。</li>
                        </ul>
                    </li>
                    <li>
                        移除依赖
                        <ul>
                            <li>poetry remove &lt;package>：从项目中移除一个依赖。</li>
                        </ul>
                    </li>
                    <li>
                        更新依赖
                        <ul>
                            <li>poetry update：更新所有依赖到最新版本。</li>
                            <li>poetry update &lt;package>：更新指定的依赖。</li>
                        </ul>
                    </li>
                    <li>
                        查看依赖
                        <ul>
                            <li>poetry show：显示项目的所有依赖。</li>
                            <li>poetry show --tree：以树状图形式显示依赖。</li>
                        </ul>
                    </li>
                    <li>
                        构建包
                        <ul>
                            <li>poetry build：构建你的包，可以生成源码包和wheel文件。</li>
                        </ul>
                    </li>
                    <li>
                        发布包
                        <ul>
                            <li>poetry publish：将你的包发布到PyPI。</li>
                        </ul>
                    </li>
                    <li>
                        检查依赖
                        <ul>
                            <li>poetry check：检查依赖是否有任何问题。</li>
                        </ul>
                    </li>
                    <li>
                        配置
                        <ul>
                            <li>poetry config：查看或修改 poetry 的配置。</li>
                        </ul>
                    </li>
                    <li>
                        新项目初始化
                        <ul>
                            <li>poetry new &lt;project-name>：创建一个新的Python项目。</li>
                        </ul>
                    </li>
                    <li>
                        环境管理
                        <ul>
                            <li>poetry env list：列出所有虚拟环境。</li>
                            <li>poetry env use &lt;env>：切换到指定的虚拟环境。</li>
                        </ul>
                    </li>
                    <li>
                        运行脚本
                        <ul>
                            <li>poetry run &lt;command>：在项目环境中运行命令。</li>
                        </ul>
                    </li>
                </ol>
            </details>
            <p>官网介绍他有好几种安装方式：pipx、the official installer……</p>
            <h4>Ubuntu 22.04</h4>
            <p>这里选用的安装方式是：the official installer</p>
            <pre ddz-class="here-need-to-handle-by-highlight" ddz-lang="bash">
curl -sSL https://install.python-poetry.org | python3 -

#   检查版本（安装完成之后立即检查版本是不行的，你还有一步没做）
poetry --version
            </pre>
            <p>
                <img src="./image/poetry-ubuntu-001.png" alt="ubuntu 22.04 安装 poetry ：curl -sSL https://install.python-poetry.org | python3 -" />
            </p>
            <h5>添加到 PATH</h5>
            <p>有点不智能啊，还得自己搞……</p>
            <pre ddz-class="here-need-to-handle-by-highlight" ddz-lang="bash">
#   更新   /home/ddz/.bashrc  文件
export PATH="/home/ddz/.local/bin:$PATH"
            </pre>
            <p>刷新 .bashrc 文件：<line-code>source .bashrc</line-code>，注意文件路径，这里就是在主目录打开的终端</p>
            <p>
                <img src="./image/poetry-ubuntu-002.png" alt="ubuntu 22.04 安装 poetry ：添加到 PATH" />
            </p>
            <h5>设置清华镜像源</h5>
            <p>参考地址：<a href="https://mirrors.tuna.tsinghua.edu.cn/help/pypi/" target="_blank" rel="noopener noreferrer"> pypi | 镜像站使用帮助 | 清华大学开源软件镜像站 | Tsinghua Open Source Mirror</a></p>
            <pre ddz-class="here-need-to-handle-by-highlight" ddz-lang="bash">
poetry source add --priority=primary mirrors https://pypi.tuna.tsinghua.edu.cn/simple/
            </pre>
            <p>
                <img src="./image/poetry-ubuntu-003.png" alt="ubuntu 22.04 安装 poetry ：设置清华镜像源" />
            </p>
            <mark-block>
                <p>开始以为会像<line-code>pip</line-code>一样设置全局镜像，但是根据上面的截图可以看出，<line-code>poetry</line-code>不是，应该是项目级别的</p>
                <p>那么有没有一种方式可以设置全局镜像？？？</p>
            </mark-block>
            <h3>conda</h3>
            <p>本来<line-code>pip</line-code>用的挺好的，不打算安装她了，但是不行啊！命中注定有她，逃也逃不掉啊……</p>
            <p>下载地址（Anaconda 和 Miniconda 都在这里）：<a href="https://www.anaconda.com/download/success" target="_blank" rel="noopener noreferrer">Download | Anaconda</a></p>
            <h4>Windows</h4>
            <details>
                <summary>点击查看安装过程</summary>
                <p>下面是在 win11 上的安装截图</p>
                <p>
                    <img src="./image/Anaconda-win-001.png" alt="Windows 安装 Anaconda" />
                </p>
                <p>注意：看上去安装挺简单的，又在自己的电脑（ win10 ）上安装了一次，安装完成之后检查版本时<line-code>conda --version</line-code>，出现了不一样的情况：上面的 win11 安装之后直接检查没有问题，直接打印版本；但是 win10 不行，重启之后还是不行，卸载 Anaconda 之后安装 Miniconda 也是不行。难道是因为之前 win 11 安装过一次，没有卸载干净……😵😵😵 win10 下没办法，只能自己添加到环境变量了。还不错的是，后面使用时没有遇到问题。</p>
                <pre ddz-class="here-need-to-handle-by-highlight" ddz-lang="bash">
#   Anaconda 和 Miniconda 都安装了一下，最后保留了 Miniconda
#   添加到环境变量（下面几个都添加过去了）
#       注意：使用你自己的安装路径   
D:\ProgramData\miniconda3
D:\ProgramData\miniconda3\Library\bin
D:\ProgramData\miniconda3\Scripts
D:\ProgramData\miniconda3\condabin
                </pre>
            </details>
            <p>下面是一些常用的命令：</p>
            <pre ddz-class="here-need-to-handle-by-highlight" ddz-lang="bash">
#   创建虚拟环境
#       1、使用 environment.yml 文件（没有测试过）
conda env create -f environment.yml
#       2、使用命令行创建
conda create --name 环境名称 python=3.11
#	        --name 简写方式
conda create -n 环境名称 python=3.11
		
#   虚拟环境列表（可以看到你创建的虚拟环境）
conda env list
conda info --envs
	
#   激活虚拟环境
conda activate 环境名称
#   退出当前虚拟环境
conda deactivate

#   删除虚拟环境
conda remove -n 环境名称 --all
            </pre>
            <h2>__pycache__</h2>
            <details>
                <summary>kimi 的解释</summary>
                <p>__pycache__ 目录是Python解释器在运行Python代码时自动创建的，它包含了编译后的Python文件的字节码（bytecode）。这个目录的目的是为了提高程序的启动速度和运行效率。以下是__pycache__目录的一些具体用途和特点：</p>
                <ul>
                    <ol>
                        <li>存储字节码：当Python解释器执行.py文件时，它会将源代码编译成中间形式的字节码，这些字节码被存储在__pycache__目录中，文件扩展名为.pyc。</li>
                        <li>加快程序启动：如果.pyc文件存在，并且源代码自上次编译以来没有发生变化，那么Python解释器可以直接加载.pyc文件，而不需要重新编译源代码。这样可以减少程序的启动时间。</li>
                        <li>优化运行效率：由于字节码的执行速度通常比直接解释源代码要快，所以使用.pyc文件可以提高程序的运行效率。</li>
                        <li>跨平台兼容性：.pyc文件包含了平台无关的字节码，这意味着同一份字节码可以在不同的操作系统和架构上运行，只要它们有兼容的Python解释器。</li>
                        <li>减少I/O操作：由于.pyc文件的存在，减少了对磁盘上源代码文件的读取次数，从而减少了I/O操作。</li>
                        <li>调试信息：.pyc文件中包含了足够的信息，使得在调试时能够映射回原始的.py文件，这有助于开发者在调试时定位问题。</li>
                        <li>版本控制：通常建议将__pycache__目录排除在版本控制系统之外，因为它包含了编译后的文件，这些文件在不同的开发环境中可能会有所不同，而且它们不是源代码的必需部分。</li>
                    </ol>
                </ul>
                <p>总的来说，__pycache__目录是Python为了提高性能和效率而自动管理的一部分，它使得程序的加载和执行更加迅速，同时保持了跨平台的一致性。</p>
            </details>
            <p>如何删除所有的 __pycache__ 目录？你可以创建一个 py 文件，这里命名为<line-code>delete__pycache__.py</line-code>，内容如下：</p>
            <pre ddz-class="here-need-to-handle-by-highlight" ddz-lang="python">
import os
import shutil

for root, dirs, files in os.walk("."):
    for dir in dirs:
        if dir == "__pycache__":
            shutil.rmtree(os.path.join(root, dir))
            </pre>
        </div>
    </body>
</html>
