<!DOCTYPE html>
<html lang="zh-Hans-CN">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Caddy - Mock API 服务器 - xiaodu114.github.io</title>
        <meta name="keywords" content="xiaodu114,Caddy,Web服务器,HTTP/2,HTTPS,自动证书,Mock,Mock API" />
        <meta name="description" content="Caddy：我还可以作为 Mock 服务器使用哦。" />

        <script src="/p/_/js/main.js"></script>
    </head>

    <body>
        <div class="blog-page">
            <h1>Mock 服务器</h1>
            <p>Caddy 还能充当 Mock API 服务器哦！</p>
            <p>配置文件内容如下：</p>
            <pre ddz-class="here-need-to-handle-by-highlight" ddz-lang="nginx">
:9999 {
    # --- 0、全局允许跨域 ---
    header Access-Control-Allow-Origin "*"
    header Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
    header Access-Control-Allow-Headers "Authorization, Content-Type, X-Requested-With, Accept, Origin"
    header Access-Control-Allow-Credentials "false"
    header Access-Control-Max-Age "86400"

    @options method OPTIONS
    handle @options {
        respond "" 204
    }

    # --- 1、认证相关接口 ---

    # 1.1、 获取公钥
	@publicKey {
		method GET
		path /api/oauth2/publicKey
	}
    handle @publicKey {
        respond `{
            "code": 0,
            "data": "公钥放在这里哦！",
            "message": null
        }`
    }

    # 1.2、 登录
	@login {
		method POST
		path /api/oauth2/login
	}
    handle @login {
        respond `{
            "code": 0,
            "data": {
                "access_token": "mock_access_token_xyz_123",
                "token_type": "Bearer",
                "expires_in": 3600,
                "refresh_token": "mock_refresh_token_abc_456"
            },
            "message": null
        }`
    }

    # 1.3、 登出
	@logout {
		method POST
		path /api/oauth2/logout
	}
    handle @logout {
        respond `{
            "code": 0,
            "data": true,
            "message": null
        }`
    }

    # --- 2、用户管理接口 ---

    # 2.1、列表分页查询
	@user_page {
		method POST
		path /api/user/page
	}
    handle @user_page {
        respond `{
            "code": 0,
            "data": {
				"total": 6,
				"list":[
					{"id": 1, "username": "user1", "email": "user1@example.com"},
					{"id": 2, "username": "user2", "email": "user2@example.com"}
				]
			},
            "message": null
        }`
    }

    # 2.2、ID 单个查询
    @user_get {
		method GET
		path /api/user/get/*
	}
    handle @user_get {
        respond `{
            "code": 0,
            "data": {"id": 10, "username": "dynamic_user", "email": "dynamic@example.com"},
            "message": null
        }`
    }

    # 2.3、添加用户
	@user_add {
		method POST
		path /api/user/add
	}
    handle @user_add {
        respond `{
            "code": 0,
            "data": {"id": 99, "username": "new_user", "email": "newuser@example.com"},
            "message": null
        }`
    }

    # 2.4、修改用户
	@user_update {
		method PUT
		path /api/user/update/*
	}
    handle @user_update {
        respond `{
            "code": 0,
            "data": true,
            "message": null
        }`
    }

    # 2.5、删除用户
	@user_delete {
		method DELETE
		path /api/user/delete/*
	}
    handle @user_delete {
        respond `{
            "code": 0,
            "data": true,
            "message": null
        }`
    }

    # 补充：处理未匹配的路由
    respond 404
}
            </pre>
            <p>启动命令如下：</p>
            <pre ddz-class="here-need-to-handle-by-highlight" ddz-lang="bash">
caddy run --config "D:\ProgramOther\web-servers\caddy-server\mock\Caddyfile"
            </pre>
        </div>
    </body>
</html>
