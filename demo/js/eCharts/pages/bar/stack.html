<!DOCTYPE html>
<html lang="zh-Hans-CN">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Apache ECharts - 堆叠柱状图 - xiaodu114.github.io</title>
        <meta name="keywords" content="xiaodu114,Apache ECharts,图表,堆叠柱状图" />
        <meta name="description" content="Apache ECharts 之堆叠柱状图" />

        <script src="/p/_/js/main.js"></script>
        <script type="importmap">
            {
                "imports": {
                    "echarts": "https://registry.npmmirror.com/echarts/6.0.0/files/dist/echarts.esm.min.js"
                }
            }
        </script>
    </head>

    <body>
        <div class="blog-page">
            <h1>Apache ECharts 之堆叠柱状图</h1>
            <h2>伪 3D 堆叠柱状图</h2>
            <div id="chart" style="width: 100%; height: 521px"></div>
        </div>
        <script type="module">
            import * as echarts from "echarts";

            const myChart = echarts.init(document.getElementById("chart"));

            const xAxisData = ["周一", "周二", "周三", "周四", "周五"];
            const seriesData1_1 = [120, 132, 101, 134, 90]; // 数据一
            const seriesData1_2 = [220, 182, 191, 234, 290]; // 数据二
            const seriesData1_Total = seriesData1_1.map((v, i) => v + seriesData1_2[i]); // 总数

            const seriesData2_1 = [150, 232, 201, 154, 190]; // 数据一
            const seriesData2_2 = [320, 332, 301, 334, 390]; // 数据二
            const seriesData2_Total = seriesData2_1.map((v, i) => v + seriesData2_2[i]); // 总数

            const dataColors = ["#007AD7", "#FFCD45", "#00B732", "#F35C2A"];
            const dataTopColors = ["#FFE08A", "#FFB39A"];

            const barWidth = 30;
            const pictorialBarSymbolSize = [barWidth, barWidth / 2]; //  伪 3D 效果大小

            const option = {
                grid: {
                    left: 0,
                    right: 0,
                    bottom: 0,
                    containLabel: true
                },
                tooltip: {
                    trigger: "axis",
                    axisPointer: {
                        type: "shadow"
                    }
                },
                legend: {
                    data: ["柱一-数据一", "柱一-数据二", "柱二-数据一", "柱二-数据二"],
                    top: 20,
                    right: "4%"
                },
                xAxis: {
                    type: "category",
                    data: xAxisData,
                    axisLabel: {
                        interval: 0,
                        rotate: 0
                    }
                },
                yAxis: [
                    {
                        type: "value",
                        position: "left",
                        axisLabel: {
                            formatter: "{value}"
                        }
                    },
                    {
                        type: "value",
                        position: "right",
                        show: false,
                        axisLabel: {
                            formatter: "{value}"
                        }
                    }
                ],
                series: [
                    //  堆叠柱一 - 数据一
                    {
                        name: "柱一-数据一",
                        type: "bar",
                        stack: "video",
                        yAxisIndex: 0,
                        data: seriesData1_1,
                        barWidth,
                        itemStyle: {
                            color: dataColors[0]
                        }
                    },
                    //  堆叠柱一 - 数据二
                    {
                        name: "柱一-数据二",
                        type: "bar",
                        stack: "video",
                        yAxisIndex: 0,
                        data: seriesData1_2,
                        barWidth,
                        itemStyle: {
                            color: dataColors[1]
                        }
                    },
                    {
                        name: "堆叠柱一 - 底部伪 3D 效果",
                        type: "pictorialBar",
                        stack: "video",
                        yAxisIndex: 0,
                        symbol: "diamond", // 梯形路径，模拟 3D 顶部
                        symbolSize: pictorialBarSymbolSize,
                        symbolOffset: ["-100%", "50%"], // 调整位置，与 bar 对齐
                        z: 10,
                        data: [1, 1, 1, 1, 1],
                        tooltip: {
                            show: false // 避免重复 tooltip
                        },
                        itemStyle: {
                            color: dataColors[0]
                        }
                    },
                    {
                        name: "堆叠柱一 - 交界伪 3D 效果",
                        type: "pictorialBar",
                        stack: "video",
                        yAxisIndex: 0,
                        symbol: "diamond",
                        symbolPosition: "end",
                        symbolSize: pictorialBarSymbolSize,
                        symbolOffset: ["-100%", "-50%"],
                        z: 10,
                        data: seriesData1_1,
                        tooltip: {
                            show: false
                        },
                        itemStyle: {
                            color: dataColors[1]
                        }
                    },
                    {
                        name: "堆叠柱一 - 顶部伪 3D 效果",
                        type: "pictorialBar",
                        stack: "video",
                        yAxisIndex: 0,
                        symbol: "diamond",
                        symbolPosition: "end",
                        symbolSize: pictorialBarSymbolSize,
                        symbolOffset: ["-100%", "-50%"],
                        z: 10,
                        data: seriesData1_Total,
                        tooltip: {
                            show: false
                        },
                        itemStyle: {
                            color: dataTopColors[0]
                        }
                    },
                    // 堆叠柱二 - 数据一
                    {
                        name: "柱二-数据一",
                        type: "bar",
                        stack: "audio",
                        yAxisIndex: 1,
                        data: seriesData2_1,
                        barWidth,
                        barGap: "100%", // 与视频柱状图分开
                        itemStyle: {
                            color: dataColors[2]
                        }
                    },
                    // 堆叠柱二 - 数据二
                    {
                        name: "柱二-数据二",
                        type: "bar",
                        stack: "audio",
                        yAxisIndex: 1,
                        data: seriesData2_2,
                        barWidth,
                        barGap: "100%",
                        itemStyle: {
                            color: dataColors[3]
                        }
                    },
                    {
                        name: "堆叠柱一 - 底部伪 3D 效果",
                        type: "pictorialBar",
                        stack: "video",
                        yAxisIndex: 0,
                        symbol: "diamond", // 梯形路径，模拟 3D 顶部
                        symbolSize: pictorialBarSymbolSize,
                        symbolOffset: ["100%", "50%"], // 调整位置，与 bar 对齐
                        z: 10,
                        data: [1, 1, 1, 1, 1],
                        tooltip: {
                            show: false // 避免重复 tooltip
                        },
                        itemStyle: {
                            color: dataColors[2]
                        }
                    },
                    {
                        name: "堆叠柱二 - 交界伪 3D 效果",
                        type: "pictorialBar",
                        stack: "video",
                        yAxisIndex: 0,
                        symbol: "diamond",
                        symbolPosition: "end",
                        symbolSize: pictorialBarSymbolSize,
                        symbolOffset: ["100%", "-50%"],
                        z: 11,
                        data: seriesData2_1,
                        tooltip: {
                            show: false
                        },
                        itemStyle: {
                            color: dataColors[3]
                        }
                    },
                    {
                        name: "堆叠柱二 - 顶部伪 3D 效果",
                        type: "pictorialBar",
                        stack: "video",
                        yAxisIndex: 0,
                        symbol: "diamond",
                        symbolPosition: "end",
                        symbolSize: pictorialBarSymbolSize,
                        symbolOffset: ["100%", "-50%"],
                        z: 11,
                        data: seriesData2_Total,
                        tooltip: {
                            show: false
                        },
                        itemStyle: {
                            color: dataTopColors[1]
                        }
                    }
                ]
            };

            myChart.setOption(option);
        </script>
    </body>
</html>
